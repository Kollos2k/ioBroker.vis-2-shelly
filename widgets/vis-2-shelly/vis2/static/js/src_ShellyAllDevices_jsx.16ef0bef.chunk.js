/*! For license information please see src_ShellyAllDevices_jsx.16ef0bef.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkiobroker_vis_2_shelly=self.webpackChunkiobroker_vis_2_shelly||[]).push([["src_ShellyAllDevices_jsx","node_modules_react_jsx-runtime_js-_c9180","node_modules_react_jsx-runtime_js-_c9181","node_modules_react_jsx-runtime_js-_c9182","node_modules_react_jsx-runtime_js-_c9183"],{57087:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});a(28437);var n=a(67085),s=(a(37449),a(59797)),o=a(92525),i=a(33659),c=a(70579);class l extends(window.visRxWidget||s.VisRxWidget){constructor(e){super(e),this.state.allDevices={},console.debug("THIS"),console.debug(this)}static getWidgetInfo(){return{id:"tplAllDevicesWidget",visSet:"vis-2-shelly",visSetLabel:"vis_2_widgets_shelly",visSetColor:"#cf00ff",visName:"AllDevices",visAttrs:[{name:"common",fields:[{name:"display",label:"vis_2_widgets_shelly_display",type:"select",options:[{value:"block",label:"block"},{value:"flex",label:"flex"}],noTranslation:!0,default:"block"}]}],visPrev:"widgets/vis-2-shelly/vis2/img/editor/allDevices.png"}}async propertiesUpdate(){const e=await this.props.context.socket.getForeignStates(["vis-2-shelly.0.devices.ids"]);this.state.allDevices=JSON.parse(e["vis-2-shelly.0.devices.ids"].val)}async componentDidMount(){super.componentDidMount(),await this.propertiesUpdate()}getWidgetInfo(){return l.getWidgetInfo()}async onRxDataChanged(){console.debug("onRxDataChanged"),await this.propertiesUpdate()}async onRxStyleChanged(){}async onStateUpdated(e,t){}renderWidgetBody(e){return super.renderWidgetBody(e),console.debug(this.props.context.socket),(0,c.jsx)(n.Card,{style:{width:"100%",height:"100%"},children:(0,c.jsx)(n.CardContent,{children:Object.values(this.state.allDevices).map((e=>{this.vsID="vis-2-shelly.0.devices.".concat(e.id),this.domID=e.id.replaceAll("#","");const t=(0,i.A)(e.type,this.domID,{stateID:e.stateId,type:e.type,id:e.id},this.vsID),a="undefined"===typeof t.dataPoint?[]:t.dataPoint;return Object.entries(a).map((a=>{let[n,s]=a;const i=t.domID+n;return(0,c.jsx)(o.A,{stateID:e.stateId,type:e.type,id:e.id,typeConfig:t,deviceDomID:i,relay:n,dataPoint:s,socket:this.props.context.socket,widID:this.props.id})}))}))})})}}const r=l},92525:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(28437),s=a.n(n),o=(a(86820),a(32719)),i=(a(10614),a(70579));class c extends n.Component{constructor(e){super(e),this.el=s().createRef(null),this.components={},e.socket.subscribeState(Object.values(e.dataPoint),((e,t)=>{this.stateChange(e,t)}))}async stateChange(e,t){if("undefined"===typeof this.props.typeConfig.update)return!1;let a;if(Object.entries(this.props.dataPoint).forEach((t=>{let[n,s]=t;s===e&&(a=n)})),"undefined"===typeof this.components[a])return!1;if("undefined"===typeof this.props.typeConfig.update[a])return!1;if("function"===typeof this.props.typeConfig.update[a].updateValue){const e="undefined"===typeof t||null===t?"":t.val;this.props.typeConfig.update[a].updateValue({dom:this.components[a].current,newVal:e,config:this.props.typeConfig.update[a],socket:this.props.socket})}}async propertiesUpdate(){}async componentDidMount(){await this.propertiesUpdate()}render(){return this.components.icon=s().createRef(null),this.components.name=s().createRef(null),(0,i.jsxs)("div",{id:this.props.deviceDomID,className:"vis2_shelly_DeviceBody",title:this.props.stateID,ref:this.el,children:[(0,i.jsx)("span",{name:"status",children:(0,i.jsx)("span",{children:(0,i.jsx)("span",{className:"connectionState connectionStateOnline"})})}),(0,i.jsx)("span",{name:"icon",ref:this.components.icon}),(0,i.jsx)("span",{name:"name",ref:this.components.name,children:this.props.id}),(0,i.jsx)("span",{name:"info",children:Object.entries(this.props.typeConfig.view.info).map((e=>{let[t,a]=e;return this.components[a.name]=s().createRef(null),(0,i.jsx)("span",{name:a.name,className:a.class,ref:this.components[a.name],children:a.html})}))}),(0,i.jsx)("span",{name:"action",children:Object.entries(this.props.typeConfig.view.action).map((e=>{let[t,a]=e;return(0,i.jsx)("span",{name:a.name,children:a.html})}))})]})}}const l=(0,o.withStyles)((e=>({})))(c)},32416:(e,t,a)=>{a.d(t,{J6:()=>d,Xo:()=>c,Z8:()=>l,_M:()=>m,d7:()=>o,fO:()=>n,g6:()=>s,lz:()=>p,qn:()=>i,rx:()=>r});const n=e=>{},s=e=>{e.dom.innerHTML=e.newVal},o=e=>{e.dom.innerHTML="".concat(e.newVal," ").concat(e.config.unit)},i=e=>{e.dom.innerHTML="".concat(e.newVal," ").concat(e.config.unit)},c=e=>{},l=e=>{},r=e=>{},m=e=>{},p=e=>{},d=e=>{}},33659:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(32416),s=a(70579);const o=(e,t,a,o)=>{let i={};const c=(0,s.jsx)("object",{name:"svgShellyButton",type:"image/svg+xml",data:"/vis-2/widgets/vis-2-shelly/vis2/img/shellySwitchButton.svg",title:"Switch"}),l=(0,s.jsx)("object",{name:"svgShellyTRVButton",type:"image/svg+xml",data:"/vis-2/widgets/vis-2-shelly/vis2/img/shellyTRVButton.svg",style:{margin:"5px",width:"125px"}});switch(e){case"SHDM-2":i={domID:t,update:{power:{name:"power",unit:"W",updateValue:n.d7},brightness:{name:"brightness",unit:"%",updateValue:n.qn},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6},switch:{name:"switch",updateAck:n.rx,updateValue:n._M}},view:{info:{power:{name:"power",class:"icon",html:""},brightness:{name:"brightness",class:"icon",html:""}},action:{switch:{name:"switch",style:{width:"70px"},class:"",html:c}}},action:{switch:{name:"switch",x:"0px",y:"0px",w:"100%",h:"100%",dataPoint:"switch",click:n.J6}},dataPoint:{0:{power:"".concat(a.stateID,".lights.Power"),switch:"".concat(a.stateID,".lights.Switch"),brightness:"".concat(a.stateID,".lights.brightness"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id}}};break;case"SHPLG-S":i={domID:t,update:{power:{name:"power",unit:"W",updateValue:n.d7},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6},switch:{name:"switch",updateAck:n.rx,updateValue:n._M}},view:{info:{power:{name:"power",class:"icon",html:""}},action:{switch:{name:"switch",style:{width:"70px"},class:"",html:c}}},action:{switch:{name:"switch",x:"0px",y:"0px",w:"100%",h:"100%",dataPoint:"switch",click:n.J6}},dataPoint:{0:{power:"".concat(a.stateID,".Relay0.Power"),switch:"".concat(a.stateID,".Relay0.Switch"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id}}};break;case"shellyplus1pm":case"shellyplusplugs":i={domID:t,update:{power:{name:"power",unit:"W",updateValue:n.d7},voltage:{name:"voltage",unit:"V",updateValue:n.d7},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6},switch:{name:"switch",updateAck:n.rx,updateValue:n._M}},view:{info:{power:{name:"power",class:"icon",html:""},voltage:{name:"voltage",class:"icon",html:""}},action:{switch:{name:"switch",style:{width:"70px"},class:"",html:c}}},action:{switch:{name:"switch",x:"0px",y:"0px",w:"100%",h:"100%",dataPoint:"switch",click:n.J6}},dataPoint:{0:{power:"".concat(a.stateID,".Relay0.Power"),switch:"".concat(a.stateID,".Relay0.Switch"),voltage:"".concat(a.stateID,".Relay0.Voltage"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id}}};break;case"shellyplus2pm":i={domID:t,update:{power:{name:"power",unit:"W",updateValue:n.d7},voltage:{name:"voltage",unit:"V",updateValue:n.d7},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6},switch:{name:"switch",updateAck:n.rx,updateValue:n._M}},view:{info:{power:{name:"power",class:"icon",html:""},voltage:{name:"voltage",class:"icon",html:""}},action:{switch:{name:"switch",style:{width:"70px"},class:"",html:c}}},action:{switch:{name:"switch",x:"0px",y:"0px",w:"100%",h:"100%",dataPoint:"switch",click:n.J6}},dataPoint:{0:{power:"".concat(a.stateID,".Relay0.Power"),switch:"".concat(a.stateID,".Relay0.Switch"),voltage:"".concat(a.stateID,".Relay0.Voltage"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id},1:{power:"".concat(a.stateID,".Relay1.Power"),switch:"".concat(a.stateID,".Relay1.Switch"),voltage:"".concat(a.stateID,".Relay1.Voltage"),name:"".concat(o,".1.name"),room:"".concat(o,".1.room"),deviceID:a.id}}};break;case"shellyplusht":i={domID:t,update:{humidity:{name:"humidity",unit:"%",updateValue:n.d7},batteryPercent:{name:"devicePower",updateValue:n.Xo},externalPower:{name:"devicePower",updateValue:n.Xo},temperature:{name:"temperature",unit:"\xb0C",updateValue:n.d7},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6}},view:{info:{humidity:{name:"humidity",class:"icon",html:""},externalPower:{name:"devicePower",class:"icon",html:""}},action:{temperature:{name:"temperature",style:{width:"70px"},class:"temperature",html:""}}},dataPoint:{0:{temperature:"".concat(a.stateID,".Temperature0.Celsius"),humidity:"".concat(a.stateID,".Humidity0.Relative"),externalPower:"".concat(a.stateID,".DevicePower0.ExternalPower"),batteryPercent:"".concat(a.stateID,".DevicePower0.BatteryPercent"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id}}};break;case"SHTRV-01":i={domID:t,update:{valvePosition:{name:"valvePosition",unit:"%",updateValue:n.d7},batteryPercent:{name:"devicePower",updateValue:n.Xo},externalPower:{name:"devicePower",updateValue:n.Xo},temperature:{name:"temperature",unit:"\xb0C",updateValue:n.d7},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6},temperatureTarget:{name:"temperatureTarget",unit:"\xb0C",updateAck:n.Z8,updateValue:n.d7}},view:{info:{temperature:{name:"temperature",class:"icon",html:""},valvePosition:{name:"valvePosition",class:"icon",html:""},devicePower:{name:"devicePower",class:"icon",html:""}},action:{temperatureTarget:{name:"temperatureTarget",style:"",class:"TRVValue",html:""},buttons:{name:"buttons",style:{width:"135px"},class:"TRVButton",html:l}}},action:{down:{name:"buttons",x:"5px",y:"5px",w:"45px",h:"50px",minValue:15,maxValue:30,step:-.5,dataPoint:"temperatureTarget",click:n.lz},up:{name:"buttons",x:"85px",y:"5px",w:"45px",h:"50px",minValue:15,maxValue:30,step:.5,dataPoint:"temperatureTarget",onClick:{find:"[name='svgShellyTRVButton']",contentDocument:!0,className:"animatedAction"},click:n.lz}},dataPoint:{0:{temperature:"".concat(a.stateID,".tmp.temperatureC"),temperatureTarget:"".concat(a.stateID,".tmp.temperatureTargetC"),valvePosition:"".concat(a.stateID,".tmp.valvePosition"),externalPower:"".concat(a.stateID,".bat.charger"),batteryPercent:"".concat(a.stateID,".bat.value"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id}}};break;case"SHMOS-02":i={domID:t,update:{lux:{name:"lux",unit:"Lux",updateValue:n.d7},batteryPercent:{name:"devicePower",unit:"%",updateValue:n.d7},motion:{name:"motion",updateValue:n.fO},temperature:{name:"temperature",unit:"\xb0C",updateValue:n.d7},name:{name:"name",updateValue:n.g6},oname:{name:"name",updateValue:n.g6}},view:{info:{temperature:{name:"temperature",class:"icon",html:""},batteryPercent:{name:"batteryPercent",class:"icon",html:""},lux:{name:"lux",class:"icon",html:""}},action:{motion:{name:"motion",style:{width:"70px"},class:"",html:""}}},dataPoint:{0:{temperature:"".concat(a.stateID,".sensor.temperatureC"),motion:"".concat(a.stateID,".sensor.motion"),lux:"".concat(a.stateID,".sensor.lux"),batteryPercent:"".concat(a.stateID,".sensor.battery"),name:"".concat(o,".0.name"),room:"".concat(o,".0.room"),deviceID:a.id}}}}return i}},51153:(e,t,a)=>{var n=a(28437),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function r(e,t,a){var n,o={},r=null,m=null;for(n in void 0!==a&&(r=""+a),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(m=t.ref),t)i.call(t,n)&&!l.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:s,type:e,key:r,ref:m,props:o,_owner:c.current}}t.Fragment=o,t.jsx=r,t.jsxs=r},70579:(e,t,a)=>{e.exports=a(51153)},10614:()=>{}}]);
//# sourceMappingURL=src_ShellyAllDevices_jsx.16ef0bef.chunk.js.map